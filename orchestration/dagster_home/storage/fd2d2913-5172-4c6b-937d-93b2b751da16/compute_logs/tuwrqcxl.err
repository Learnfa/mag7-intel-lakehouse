2025-12-04 14:28:08 +0000 - dagster - DEBUG - mag7_intel_daily_job - fd2d2913-5172-4c6b-937d-93b2b751da16 - 7201 - LOGS_CAPTURED - Started capturing logs in process (pid: 7201).
2025-12-04 14:28:09 +0000 - dagster - DEBUG - mag7_intel_daily_job - fd2d2913-5172-4c6b-937d-93b2b751da16 - 7201 - news_csv - STEP_START - Started execution of step "news_csv".

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.3.5 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "<string>", line 1, in <module>
  File "/usr/local/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/usr/local/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
  File "/usr/local/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/local/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/executor/child_process_executor.py", line 79, in _execute_command_in_child_process
    for step_event in command.execute():
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/executor/multiprocess.py", line 100, in execute
    yield from execute_plan_iterator(
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/execution/api.py", line 873, in __iter__
    yield from self.iterator(
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/execution/plan/execute_plan.py", line 89, in inner_plan_execution_iterator
    for step_event in check.generator(dagster_event_sequence_for_step(step_context)):
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/execution/plan/execute_plan.py", line 247, in dagster_event_sequence_for_step
    yield from check.generator(step_events)
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/execution/plan/execute_step.py", line 504, in core_dagster_event_sequence_for_step
    for user_event in _step_output_error_checked_user_event_sequence(
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/execution/plan/execute_step.py", line 183, in _step_output_error_checked_user_event_sequence
    for user_event in user_event_sequence:
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/execution/plan/execute_step.py", line 88, in _process_asset_results_to_events
    for user_event in user_event_sequence:
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/execution/plan/compute.py", line 188, in execute_core_compute
    for step_output in _yield_compute_results(step_context, inputs, compute_fn, compute_context):
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/execution/plan/compute.py", line 157, in _yield_compute_results
    for event in iterate_with_context(
  File "/usr/local/lib/python3.11/site-packages/dagster/_utils/__init__.py", line 394, in iterate_with_context
    next_output = next(iterator)
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/execution/plan/compute_generator.py", line 135, in _coerce_op_compute_fn_to_iterator
    result = invoke_compute_fn(
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/execution/plan/compute_generator.py", line 115, in invoke_compute_fn
    return fn(context, **args_to_pass) if context_arg_provided else fn(**args_to_pass)
  File "/app/orchestration/orchestration/assets.py", line 35, in news_csv
    from src.extractors.news_extractor import run_news_extractor
  File "/app/src/extractors/news_extractor.py", line 36, in <module>
    from transformers import AutoTokenizer, AutoModelForSequenceClassification
  File "/usr/local/lib/python3.11/site-packages/transformers/__init__.py", line 27, in <module>
    from . import dependency_versions_check
  File "/usr/local/lib/python3.11/site-packages/transformers/dependency_versions_check.py", line 16, in <module>
    from .utils.versions import require_version, require_version_core
  File "/usr/local/lib/python3.11/site-packages/transformers/utils/__init__.py", line 24, in <module>
    from .auto_docstring import (
  File "/usr/local/lib/python3.11/site-packages/transformers/utils/auto_docstring.py", line 30, in <module>
    from .generic import ModelOutput
  File "/usr/local/lib/python3.11/site-packages/transformers/utils/generic.py", line 51, in <module>
    import torch
  File "/usr/local/lib/python3.11/site-packages/torch/__init__.py", line 1382, in <module>
    from .functional import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/functional.py", line 7, in <module>
    import torch.nn.functional as F
  File "/usr/local/lib/python3.11/site-packages/torch/nn/__init__.py", line 1, in <module>
    from .modules import *  # noqa: F403
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/__init__.py", line 35, in <module>
    from .transformer import TransformerEncoder, TransformerDecoder, \
  File "/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py", line 20, in <module>
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
/usr/local/lib/python3.11/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at ../torch/csrc/utils/tensor_numpy.cpp:84.)
  device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),
2025-12-04 14:28:12 +0000 - dagster - ERROR - mag7_intel_daily_job - fd2d2913-5172-4c6b-937d-93b2b751da16 - 7201 - news_csv - STEP_FAILURE - Execution of step "news_csv" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "news_csv"::

AttributeError: module 'torch.utils._pytree' has no attribute 'register_pytree_node'

Stack Trace:
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/execution/plan/utils.py", line 57, in op_execution_error_boundary
    yield
  File "/usr/local/lib/python3.11/site-packages/dagster/_utils/__init__.py", line 394, in iterate_with_context
    next_output = next(iterator)
                  ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/execution/plan/compute_generator.py", line 135, in _coerce_op_compute_fn_to_iterator
    result = invoke_compute_fn(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dagster/_core/execution/plan/compute_generator.py", line 115, in invoke_compute_fn
    return fn(context, **args_to_pass) if context_arg_provided else fn(**args_to_pass)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/orchestration/orchestration/assets.py", line 35, in news_csv
    from src.extractors.news_extractor import run_news_extractor
  File "/app/src/extractors/news_extractor.py", line 36, in <module>
    from transformers import AutoTokenizer, AutoModelForSequenceClassification
  File "/usr/local/lib/python3.11/site-packages/transformers/__init__.py", line 27, in <module>
    from . import dependency_versions_check
  File "/usr/local/lib/python3.11/site-packages/transformers/dependency_versions_check.py", line 16, in <module>
    from .utils.versions import require_version, require_version_core
  File "/usr/local/lib/python3.11/site-packages/transformers/utils/__init__.py", line 24, in <module>
    from .auto_docstring import (
  File "/usr/local/lib/python3.11/site-packages/transformers/utils/auto_docstring.py", line 30, in <module>
    from .generic import ModelOutput
  File "/usr/local/lib/python3.11/site-packages/transformers/utils/generic.py", line 465, in <module>
    _torch_pytree.register_pytree_node(
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

